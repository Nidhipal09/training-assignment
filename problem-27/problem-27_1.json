[
  {
    "operation": "modify-overwrite-beta",
    "spec": {
      "*": {
        "returnQuantityInv": "=divide(1,@(1,returnQuantity))",
        "Return Amount": "=divide(@(1,returnPrice), @(1,returnQuantityInv))",
        "Return Total Amount": "=doubleSum(@(1,Return Amount), @(1,returnTax))"
      }
    }
  },
  {
    "operation": "shift",
    "spec": {
      "*": {
        "returnId": "[#2].Return Id",
        "Return Amount|Return Total Amount": "[#2].&",
        "country": {
          "USA": {
            "#United States of America": "[0].Country"
          },
          "CA": {
            "#Canada": "[1].Country"
          },
          "": {
            "#NA": "[2].Country"
          }
        }
      }
    }
  }
]